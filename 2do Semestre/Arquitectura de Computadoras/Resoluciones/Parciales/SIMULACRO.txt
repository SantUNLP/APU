CONT EQU 10H
COMP EQU 11H
PIC EQU 20H
EOI EQU 20H
IMR EQU 21H
INT0 EQU 24H
INT1 EQU 25H
PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H
ID_F10 EQU 5
ID_CLK EQU 10

ORG 20
DW 3500H

ORG 40
DW 3000H

ORG 3000H
ING_CAR: CMP CL, 5
JZ imp
INT 6
CALL MANDARDATO
INC BX
INC CL
MOV AL, 0
OUT CONT, AL
MOV AL, EOI
OUT EOI, AL
IRET

ORG 3500H
JMP imp

ORG 3700H
MANDARDATO:
MOV AL, [BX]
OUT PA, AL
RET

ORG 1000H
CADENA DB ?

ORG 2000H
MOV CL, 0
MOV BX, OFFSET CADENA
CLI
MOV AL, 0
OUT CA, AL
MOV AL, 11111100B
OUT IMR, AL
MOV AL, ID_F10
OUT INT0, AL
MOV AL, ID_CLK
OUT INT1, AL
MOV AL, 2
OUT COMP, AL
MOV AL, 0
OUT CONT, AL
STI
LOOP: JMP LOOP
imp: IN AL, PA
MOV [BX], AL
MOV AL, CL
INT 7
INT 0
END